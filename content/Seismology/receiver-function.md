---
title: 接收函数
date: 2017-05-18
---

## 基本原理

对于任意一个远震记录，将 R 分量反卷积 Z 分量即得到接收函数。接收函数是台站下方介质对远震入射
P 波的介质响应。

以最简单的单层地壳模型为例，接收函数中主要的震相是直达 P，Ps, PpSs, PsPs 等。
一个典型的接收函数如图所示。

![](https://ws2.sinaimg.cn/large/006tKfTcly1ffqt93rfjzj311g0jan00.jpg)

接收函数反映了台站下方的介质信息，因而可以用于约束台站下方结构。接收函数中可用的信息包括但不限于：

1. 震相走时差
2. 震相相对振幅
3. 波形

基本假设：

1. 台站下方的介质响应可近似为一个脉冲函数

## 基本流程

1.  数据筛选

    1. Mw>5.5
    2. 震中距: 30-95

2.  以 P 波走时作为参考，截取 -30 s 到 120 s 的波形
3.  旋转至 RTZ 分量
4.  R 分量反卷积 Z 分量得到接收函数
5.  利用接收函数反演地下结构

## 基本参数

利用 TauP 可以计算接收函数的一些基本参数:

```
$ taup_time -mod prem -ph P,P24.4s -h 100 -deg 36
$ taup_time -mod prem -ph P,P24.4s -h 100 -deg 98
$ taup_pierce -mod prem -ph P,P24.4s -h 100 -deg 36
$ taup_pierce -mod prem -ph P,P24.4s -h 100 -deg 98
```

震中距|Ps-P走时(s) | Ps-P入射角(度)| Ps-P 离台站距离(度) | Ps-P 射线参数 (s/deg)
------|------------|---------------|----------------|-----------
36度 | 414.37-411.03=3.34 | 14.17 vs 26.35 | 0.06 vs 0.12 | 8.507 vs 8.511
98度 | 806.64-803.46=3.17 | 7.33 vs 13.36  | 0.03 vs 0.06 | 4.430 vs 4.431

一些总结:

1. 在PREM模型下，接收函数的可用震中距范围大概在36-98度
2. Ps-P走时差随震中距变化很小
3. Ps, P在Moho的穿透点与台站的水平距离在 13 km 之内 => 不同震中距的接收函数采样了台站下方半径13km的圆锥
4. Ps-P走时差、P和Ps入射角以及Ps-P与台站的距离对震源深度不敏感 => 不同深度的接收函数可以直接叠加

## 反卷积

计算接收函数的核心在于反卷积。

### 频率域除法

时间域的反卷积等效于频率域的除法。因而，接收函数理论上可用如下公式计算：

$$ R(w)=\frac{U_R(w)}{U_Z(w)} $$

但频率域除法在遇到高频噪声以及频谱中低值时很不稳定，类似于数学中的除0。

### water level 法

water level法的做法是人为给谱域除法加上一个常数，使得分母上的谱不小于这一常数值。

基本公式：

$$ r(\omega) = (1+c) \frac{R(\omega)S^*(\omega)}{|S(\omega)|^2+c\sigma_0^2} e^{-\frac{\omega^2}{4\alpha^2}} $$

几点说明:

1.  引入 $S^*(\omega)$ 的目的是为了使分母变成实数，将复数除法变成乘法
2.  $e^{-\frac{\omega^2}{4\alpha^2}}$ 对得到的结果做高斯低通滤波以消除高频噪声的影响，根据
    $\alpha$ 的值可以计算出滤波器的截止频率
3.  为了防止除零或除以小值导致结果不稳定，加入了 $c\sigma_0^2$ 项，c的选取需要
    根据频率域除法的结果以及经验判断，通常取0.1-0.5
4.  $1+c$ 的目的在于补偿由于water level造成的振幅损失

### Stacked Time domain deconvolution

### 时间域迭代反卷积

## 反演

### 震相相对走时直接反演法

根据地震学基本公式 $dt = p dx + \eta dz$ 以及 射线参数保持不变这一特性，得到

$$ T = p X + \int \eta dz $$

其中 T 是震相走时，X 是震中距，p 是射线参数，$\eta$ 是垂直慢度。

进一步得到：

$$ T = p X + \int_h^{hmax} \eta dz + \int_{hmax}^{H} \eta dz + \int_{H}^0 \eta dz $$

其中 h 是震源深度，hmax 是射线最深穿透深度，H 是 Moho 深度。

下面以36度为例，分别讨论上面四项对 Ps-P 走时差的贡献：

1.  $p_1 * X - p_0 * X = (8.507-8.511) * X = -0.004*X=-0.15 s$
2.  $\eta_1 - \eta_2 = \sqrt{\frac{1}{Vp^2}-p_1^2} - \sqrt{\frac{1}{Vp^2}-p_1^2}$
    由此可以估算出第二项以及第三项的贡献之和大约是0.1 s

由此可知，第一、二、三项的贡献很小，可以忽略，进而得到：

$$ t_{Ps-P} = H * (\sqrt{\frac{1}{V_s^2}-p^2} - \sqrt{\frac{1}{V_p^2}-p^2}) $$

即，接收函数中 Ps-P 走时差与地壳内平均 Vp、Vs、射线参数 p 和地壳厚度 H 有关。

由此，可根据 Ps-P 走时差反演得到 Vp、Vs 和 H。

此方法的缺点在于：

1. Ps 震相微弱，难以拾取
2. Moho深度与Vp/Vs之间存在trade-off，即存在多个 H 与 Vp/Vs 的组合计算得到的 Ps-P 走时差与观测相同。

### h-k 法

如果只使用 Ps-P 走时差，由于 Moho深度与 Vp/Vs 存在 trade-off，所以无法约束介质结构。

hk 方法额外引入了 PsPs 和 PpSs+PsPs 震相。对于每个Moho深度 H 和 k 值，可计算理论的三个
走时残差，然后将三个走时所对应的振幅按照如下公式

$$ s(H,k) = w_1 r(t_1) + w_2 r(t_2) + w_3 r(t_3)$$

加权起来作为该点的值，最终得到 h-k 图。

此法适用于同一个台站多个地震的多个接收函数，对于每个接收函数，均可计算出 $s(H,k)$，然后对所有
计算得到的 $s(H,k)$ 做叠加即可。

## 疑问

1. 为什么R 反卷积 Z 就得到接收函数？接收函数的本质是什么？
2. 为什么 Z 分量可以近似为脉冲函数？
